{% set initialStyle = '' %}
{% if  this.height > 0 %}
{% set initialStyle = "--img-aspect: " ~ (this.width  / this.height) ~ "; --img-width: " ~ this.width ~ "px;" %}
{% endif %}

<div {{ attributes.defaults(stimulus_controller(this.controller, {
	src: asset(this.decoratedSrc),
	hash: this.hash
})).defaults({
	class:'progressive-image-container',
	style: initialStyle
}) }}
>
	<canvas
			{{ stimulus_target(this.controller,'placeholder') }}
			class="progressive-image-placeholder"
			title="{{ 'Loading...'|trans }}"
	></canvas>

	<img
			{{ stimulus_target(this.controller,'highRes') }}
			class="progressive-image-high-res"
			alt="{{ this.alt }}"
	>
	<div
			{{ stimulus_target(this.controller,'errorOverlay') }}
			class="progressive-image-error-overlay"
	>
		<div class="progressive-image-error-content">
			<h6 class="progressive-image-error-title">404</h6>
			<p class="progressive-image-error-message">
				{{ '404 image not found'|trans }}
			</p>
		</div>
	</div>
</div>